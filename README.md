# Анализ транзакций для Аларм

Скрипт для анализа успешных транзакций из Excel-файлов.

## Требования

- Python 3.6+
- Установленные зависимости из `requirements.txt`

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/bah223/calc_stats.git
   cd calc_stats
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   
   Или установите вручную:
   ```bash
   pip install pandas openpyxl
   ```

## Использование

1. Поместите Excel-файлы с транзакциями в папку со скриптом.
2. Запустите скрипт:
   ```bash
   python calc_stats.py
   ```

## Формат файлов

Скрипт ищет файлы по шаблону: `Transaction-List-Date_*.xlsx`

Ожидаемая структура файла:
- Колонка 6 (индекс 5): статус транзакции
- Колонка 7 (индекс 6): сумма в RUB

## Вывод

Скрипт выводит:
- Общее количество операций
- Количество успешных операций (со статусом 'CAPTURED')
- Процент успешных операций
- Оборот за сутки

## Скрипт `angelina_report.py`

Этот скрипт формирует расширенный отчёт по каждому файлу:

- Подсчитывает количество и сумму транзакций для статусов:
  - `CAPTURED`
  - `CANCELLED`
  - `DECLINED`
  - `REFUNDED`
- Выводит сводку по каждому файлу отдельно.

### Запуск

```bash
python angelina_report.py
```

### Что вы увидите
```
------------------------------------------------------------
- Успешных транзакций (CAPTURED): 120 шт на сумму 1 234 567,89
- Неоплаченных транзакций (CANCELLED): 5 шт на сумму 12 345,67
- Отклонённых транзакций (DECLINED): 3 шт на сумму 8 765,43
- Возвраты (REFUNDED): 2 шт на сумму 1 000,00

✅ Обработка завершена.
```

