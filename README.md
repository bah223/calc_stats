# Анализ транзакций для Аларм и Ангелины

## Скрипт `calc_stats.py`

## Требования

- Python 3.6+
- Установленные зависимости из `requirements.txt`

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/bah223/calc_stats.git
   cd calc_stats
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   
   Или установите вручную:
   ```bash
   pip install pandas openpyxl
   ```

## Быстрый старт под Windows

Если вы работаете в Windows и не хотите возиться с командной строкой:

```cmd
run_scripts.bat
```

Бат-файл автоматически:
- проверит, установлены ли зависимости (`pandas`, `openpyxl`);
- при необходимости установит/обновит их через `pip`;
- предложит выбрать, какой из скриптов запустить:
  1. `angelina_report.py`
  2. `calc_stats.py`

После выполнения выбранного скрипта окно останется открытым, чтобы вы могли увидеть результат.

---

## Использование

1. Поместите Excel-файлы с транзакциями в папку со скриптом.
2. Запустите скрипт:
   ```bash
   python calc_stats.py
   ```

## Формат файлов

Скрипт ищет файлы по шаблону: `Transaction-List-Date_*.xlsx`

Ожидаемая структура файла:
- Колонка 6 (индекс 5): статус транзакции
- Колонка 7 (индекс 6): сумма в RUB

## Вывод

Скрипт выводит:
- Общее количество операций
- Количество успешных операций (со статусом 'CAPTURED')
- Процент успешных операций
- Оборот за сутки
```
=== Результаты анализа ===
Всего операций: 7100
Успешных операций: 6200
Success Rate: 87.32%
Оборот за сутки: 6,597,305.43 RUB
```
## Скрипт `angelina_report.py`

Этот скрипт формирует расширенный отчёт по каждому файлу:

- Подсчитывает количество и сумму транзакций для статусов:
  - `CAPTURED`
  - `CANCELLED`
  - `DECLINED`
  - `REFUNDED`
- Выводит сводку по каждому файлу отдельно.

### Запуск

```bash
python angelina_report.py
```

### Что вы увидите
```
=== Результаты анализа ===
- Успешных транзакций (CAPTURED): 479 шт на сумму 7 744 886,92 RUB
- Неоплаченных транзакций (CANCELLED): 202 шт на сумму 7 055 557,00 RUB
- Отклоненных транзакций (DECLINED): 0 шт на сумму 0,00 RUB
- Возвраты (REFUNDED): 7 шт на сумму 34 700,00 RUB

✅ Обработка завершена.
```
