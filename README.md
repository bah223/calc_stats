# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ—á—Ç–∏ –Ω–∞ –≤—Å–µ —Å–ª—É—á–∞–∏ –∂–∏–∑–Ω–∏

## –°–∫—Ä–∏–ø—Ç `calc_stats.py`

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.6+
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/bah223/calc_stats.git
   cd calc_stats
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```
   
   –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:
   ```bash
   pip install pandas openpyxl
   ```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–æ–¥ Windows

–ï—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ Windows –∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–æ–∑–∏—Ç—å—Å—è —Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π:

```cmd
run_scripts.bat
```

–ë–∞—Ç-—Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ø—Ä–æ–≤–µ—Ä–∏—Ç, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pandas`, `openpyxl`);
- –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç/–æ–±–Ω–æ–≤–∏—Ç –∏—Ö —á–µ—Ä–µ–∑ `pip`;
- –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±—Ä–∞—Ç—å, –∫–∞–∫–æ–π –∏–∑ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
  1. `angelina_report.py`
  2. `calc_stats.py`
  3. `12oo.py`

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –æ–∫–Ω–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ Excel-—Ñ–∞–π–ª—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –≤ –ø–∞–ø–∫—É —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   python calc_stats.py
   ```

## –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤

–°–∫—Ä–∏–ø—Ç –∏—â–µ—Ç —Ñ–∞–π–ª—ã –ø–æ —à–∞–±–ª–æ–Ω—É: `Transaction-List-Date_*.xlsx`

–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:
- –ö–æ–ª–æ–Ω–∫–∞ 6 (–∏–Ω–¥–µ–∫—Å 5): —Å—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ö–æ–ª–æ–Ω–∫–∞ 7 (–∏–Ω–¥–µ–∫—Å 6): —Å—É–º–º–∞ –≤ RUB

## –í—ã–≤–æ–¥

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'CAPTURED')
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–±–æ—Ä–æ—Ç –∑–∞ —Å—É—Ç–∫–∏
```
=== –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ ===
–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: 7100
–£—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: 6200
Success Rate: 87.32%
–û–±–æ—Ä–æ—Ç –∑–∞ —Å—É—Ç–∫–∏: 6,597,305.43 RUB
```
## –°–∫—Ä–∏–ø—Ç `angelina_report.py`

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É:

- –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Å—É–º–º—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤:
  - `CAPTURED`
  - `CANCELLED`
  - `DECLINED`
  - `REFUNDED`
- –í—ã–≤–æ–¥–∏—Ç —Å–≤–æ–¥–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É –æ—Ç–¥–µ–ª—å–Ω–æ.

### –ó–∞–ø—É—Å–∫

```bash
python angelina_report.py
```

### –ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ
```
=== –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ ===
- –£—Å–ø–µ—à–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (CAPTURED): 479 —à—Ç –Ω–∞ —Å—É–º–º—É 7 744 886,92 RUB
- –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (CANCELLED): 202 —à—Ç –Ω–∞ —Å—É–º–º—É 7 055 557,00 RUB
- –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (DECLINED): 0 —à—Ç –Ω–∞ —Å—É–º–º—É 0,00 RUB
- –í–æ–∑–≤—Ä–∞—Ç—ã (REFUNDED): 7 —à—Ç –Ω–∞ —Å—É–º–º—É 34 700,00 RUB

‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
```

## –°–∫—Ä–∏–ø—Ç `12oo.py`

–°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç Excel-—Ñ–∞–π–ª—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –¥–æ 12:00 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏.

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –ø–æ —à–∞–±–ª–æ–Ω—É `Transaction-List-Date_*.xlsx`
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –º–æ—Å–∫–æ–≤—Å–∫–∏–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å (UTC+3)
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏
- –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É

### –ó–∞–ø—É—Å–∫

```bash
python 12oo.py
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
üìÅ –ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: 2
 - Transaction-List-Date_20230101.xlsx
 - Transaction-List-Date_20230102.xlsx
‚úÖ Transaction-List-Date_20230101.xlsx: 150 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ 12:00
‚úÖ Transaction-List-Date_20230102.xlsx: 200 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ 12:00

==================================================
üìä –í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ 12:00 –ø–æ –ú–æ—Å–∫–≤–µ: 350
==================================================
```
